package collector

import (
	"github.com/pimmytrousers/melk/collector/malware"
	"github.com/pimmytrousers/melk/collector/sources/malbazaar"
	"github.com/pimmytrousers/melk/collector/sources/mock"
	"github.com/pimmytrousers/melk/collector/sources/phisher"
	log "github.com/sirupsen/logrus"
)

// MalwareSource is a source of malware.
type MalwareSource interface {
	// Start processing the samples
	// This is blocking, you should most likely start this in a new thread
	Start(*log.Logger) error
	// Channel where malware will be provided through
	MalwareChannel() chan *malware.Malware
}

// Sources are the built in sources you can use
var Sources = []MalwareSource{
	&malbazaar.Malbazaar{},
	&phisher.Phisher{},
	&mock.Mock{},
}
